<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Abraham Horus | VIP App</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00ff88">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/logo192.png">

    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body class="not-logged">

    <header class="top-bar">
        <div class="logo">HORUS</div>
        
        <div class="stats-bar">
            <div class="stat-item">
                üë• <span id="total-subs">0</span>
            </div>
        </div>

        <div class="user-area" onclick="window.abrirPerfil()">
            <img id="header-avatar" src="https://i.imgur.com/6VBx3io.png" alt="User">
        </div>
    </header>

    <main class="app-container">
        <button id="mobile-chat-toggle" onclick="window.toggleChat()">
            üí¨ <span id="btn-live-count" class="live-count-badge">‚óè 0</span>
        </button>

        <div id="p-videos" class="app-page active">
            <div class="video-main-wrapper">
                <div class="video-carousel">
                    <button class="carousel-btn prev" onclick="window.changeVideo(-1)">‚ùÆ</button>
                    <div class="video-container">
                        <video id="main-video" controls playsinline poster="assets/shot 1.jpeg">
                            <source id="video-source" src="" type="video/mp4">
                        </video>
                    </div>
                    <button class="carousel-btn next" onclick="window.changeVideo(1)">‚ùØ</button>
                </div>
                
                <div class="video-actions-v2">
                    <div class="action-stats">
                        <div class="likes-btn" onclick="window.darLike()">‚ù§Ô∏è <span id="likes-count">0</span></div>
                        <div class="views-display">üëÅÔ∏è <span id="total-views">0</span></div>
                        <div class="likes-btn" onclick="window.toggleComments()">üí¨ <span id="comments-count">0</span></div>
                    </div>
                    <div class="video-description-box">
                        <h1 id="v-title" class="video-title">Cargando...</h1>
                        <p id="v-desc" class="video-text">Cargando descripci√≥n...</p>
                    </div>
                </div>

                <div id="comments-wrapper" class="comments-section" style="display: none;">
                    <div class="comment-input-block">
                        <input type="text" id="comment-text" placeholder="Escribe un comentario...">
                        <button onclick="window.enviarComentario()">POST</button>
                    </div>
                    <div id="comments-list"></div>
                </div>
            </div>

            <div id="chat-sidebar" class="chat-section-wrapper">
                <div class="chat-header">
                    <span>LIVE CHAT <span id="desk-live-count" style="color:red; margin-left:5px;">‚óè 0</span></span>
                    <button class="close-chat" onclick="window.toggleChat()">‚úï</button>
                </div>
                <div id="chat-box" class="chat-messages"></div>
                <div class="chat-input-area">
                    <input type="text" id="user-msg" placeholder="Habla con El Patr√≥n...">
                    <button id="send-msg" onclick="window.enviarMsg()">ENVIAR</button>
                </div>
            </div>
        </div>

        <div id="p-musica" class="app-page">
            <div class="lock-overlay">
                <h2>üíé M√öSICA EXCLUSIVA</h2>
                <p>Acceso solo para la familia VIP.</p>
                <button onclick="window.loginGoogle()" class="btn-premium">ENTRAR CON GOOGLE</button>
            </div>
            
            <div class="music-container">
                <h2 class="section-title">AUDIO PLAYER</h2>
                <div class="main-audio-player">
                    <div class="now-playing-info">
                        <img id="track-cover" src="assets/cover-despierto.jpg" alt="Cover">
                        <div class="track-text">
                            <h3 id="track-title">Selecciona un tema</h3>
                            <p id="track-artist">Abraham Horus</p>
                        </div>
                    </div>
                    <audio id="audio-element" controls style="width: 100%; margin-top: 20px; filter: invert(1); opacity: 0.8;"></audio>
                </div>

                <h3 class="section-subtitle" style="margin: 30px 0 15px; color: var(--accent); font-size: 0.8rem; letter-spacing: 3px;">TRACKLIST EXCLUSIVO</h3>
                <div id="music-list" class="music-grid"></div>
            </div>
        </div>

        <div id="p-photos" class="app-page">
             <div class="lock-overlay">
                <h2>üì∏ GALER√çA PRIVADA</h2>
                <p>Contenido exclusivo del Patr√≥n.</p>
                <button onclick="window.loginGoogle()" class="btn-premium">ENTRAR CON GOOGLE</button>
            </div>
            <div class="events-container">
                <h2 class="section-title">Galer√≠a</h2>
            </div>
        </div>

        <div id="p-eventos" class="app-page">
            <div class="lock-overlay">
                <h2>üóìÔ∏è PR√ìXIMAS FECHAS</h2>
                <button onclick="window.loginGoogle()" class="btn-premium">ENTRAR CON GOOGLE</button>
            </div>
            <div class="events-container">
                <h2 class="section-title">Tour & Eventos</h2>
            </div>
        </div>

        <div id="p-profile" class="app-page">
            <div class="profile-container">
                <h2 class="section-title">CONFIGURACI√ìN</h2>
                <div class="profile-card">
                    <img id="profile-preview" src="https://i.imgur.com/6VBx3io.png" class="big-avatar">
                    <div class="input-group">
                        <label>Tu Apodo</label>
                        <input type="text" id="edit-name" placeholder="Tu nombre en el chat">
                    </div>
                    <div class="input-group">
                        <label>Foto de Perfil (URL)</label>
                        <input type="text" id="edit-photo" placeholder="Link de tu imagen">
                    </div>
                    <button class="btn-save" onclick="window.guardarPerfil()">GUARDAR CAMBIOS</button>
                    <div style="margin-top: 20px; width: 100%; border-top: 1px solid #222; padding-top: 20px;">
                        <button class="btn-logout" onclick="window.cerrarSesion()">CERRAR SESI√ìN</button>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <nav class="bottom-nav">
        <div id="nav-live" class="nav-item active" onclick="window.showPage('p-videos', this)">
            üì∫<span>Live</span>
            <div id="live-badge" class="badge-live">!</div>
        </div>
        <div id="nav-music" class="nav-item" onclick="window.showPage('p-musica', this)">
            üéµ<span>M√∫sica</span>
        </div>
        <div id="nav-photos" class="nav-item" onclick="window.showPage('p-photos', this)">
            üì∏<span>Fotos</span>
        </div>
        <div id="nav-events" class="nav-item" onclick="window.showPage('p-eventos', this)">
            üóìÔ∏è<span>Eventos</span>
        </div>
    </nav>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="app.js"></script>

    <audio id="ding-sound" src="assets/Gemido de tortuga.mp3" preload="auto"></audio>

    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js')
            .then(reg => console.log('App lista para instalar!', reg))
            .catch(err => console.log('Error en PWA', err));
        });
      }
    </script>
</body>
</html>